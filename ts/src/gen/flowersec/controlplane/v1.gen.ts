// Code generated by idlgen. DO NOT EDIT.

/** Endpoint role for tunnel attach. */
export enum Role {
  /** Client endpoint. */
  Role_client = 1,
  /** Server endpoint. */
  Role_server = 2,
}

/** E2EE cipher suite identifier. */
export enum Suite {
  /** P-256 + HKDF-SHA256 + AES-256-GCM. */
  Suite_P256_HKDF_SHA256_AES_256_GCM = 2,
  /** X25519 + HKDF-SHA256 + AES-256-GCM. */
  Suite_X25519_HKDF_SHA256_AES_256_GCM = 1,
}

/** Grant issued by controlplane to attach and start E2EE. */
export interface ChannelInitGrant {
  /** WebSocket URL of the tunnel server. */
  tunnel_url: string;
  /** Channel identifier shared by both endpoints. */
  channel_id: string;
  /** Unix timestamp when the grant expires. */
  channel_init_expire_at_unix_s: number;
  /** Server idle timeout hint in seconds. */
  idle_timeout_seconds: number;
  /** Role for this grant (client or server). */
  role: Role;
  /** Signed tunnel attach token. */
  token: string;
  /** Base64url-encoded 32-byte PSK. */
  e2ee_psk_b64u: string;
  /** Allowed E2EE cipher suites. */
  allowed_suites: Suite[];
  /** Default E2EE cipher suite. */
  default_suite: Suite;
}

