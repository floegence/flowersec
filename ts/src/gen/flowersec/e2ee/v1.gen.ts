// Code generated by idlgen. DO NOT EDIT.

/** Feature bitset advertised during handshake. */
export enum E2EEFeatureBits {
  /** Supports rekey control records. */
  E2EEFeatureBits_rekey = 1,
}

/** Record type indicator for encrypted frames. */
export enum RecordFlags {
  /** Application data record. */
  RecordFlags_app = 0,
  /** Ping record. */
  RecordFlags_ping = 1,
  /** Rekey control record. */
  RecordFlags_rekey = 2,
}

/** Endpoint role for the E2EE handshake. */
export enum Role {
  /** Client endpoint. */
  Role_client = 1,
  /** Server endpoint. */
  Role_server = 2,
}

/** E2EE cipher suite identifier. */
export enum Suite {
  /** P-256 + HKDF-SHA256 + AES-256-GCM. */
  Suite_P256_HKDF_SHA256_AES_256_GCM = 2,
  /** X25519 + HKDF-SHA256 + AES-256-GCM. */
  Suite_X25519_HKDF_SHA256_AES_256_GCM = 1,
}

/** Client handshake ack payload. */
export interface E2EE_Ack {
  /** Handshake identifier being acknowledged. */
  handshake_id: string;
  /** Client Unix timestamp used for the auth tag. */
  timestamp_unix_s: number;
  /** Base64url-encoded auth tag. */
  auth_tag_b64u: string;
}

/** Client handshake init payload. */
export interface E2EE_Init {
  /** Channel identifier. */
  channel_id: string;
  /** Role of the sender (client). */
  role: Role;
  /** Protocol version. */
  version: number;
  /** Requested cipher suite. */
  suite: Suite;
  /** Base64url-encoded client ephemeral public key. */
  client_eph_pub_b64u: string;
  /** Base64url-encoded client nonce (32 bytes). */
  nonce_c_b64u: string;
  /** Client feature bits. */
  client_features: number;
}

/** Server handshake response payload. */
export interface E2EE_Resp {
  /** Handshake identifier for retries. */
  handshake_id: string;
  /** Base64url-encoded server ephemeral public key. */
  server_eph_pub_b64u: string;
  /** Base64url-encoded server nonce (32 bytes). */
  nonce_s_b64u: string;
  /** Server feature bits. */
  server_features: number;
}

