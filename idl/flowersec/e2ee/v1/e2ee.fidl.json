{
  "namespace": "flowersec.e2ee.v1",
  "enums": {
    "Role": {
      "type": "u8",
      "values": { "client": 1, "server": 2 }
    },
    "Suite": {
      "type": "u16",
      "values": {
        "X25519_HKDF_SHA256_AES_256_GCM": 1,
        "P256_HKDF_SHA256_AES_256_GCM": 2
      }
    },
    "RecordFlags": {
      "type": "u8",
      "values": { "app": 0, "ping": 1, "rekey": 2 }
    },
    "E2EEFeatureBits": {
      "type": "u32",
      "values": { "rekey": 1 }
    }
  },
  "messages": {
    "E2EE_Init": {
      "fields": [
        { "name": "channel_id", "type": "string" },
        { "name": "role", "type": "Role" },
        { "name": "version", "type": "u8" },
        { "name": "suite", "type": "Suite" },
        { "name": "client_eph_pub_b64u", "type": "string" },
        { "name": "nonce_c_b64u", "type": "string" },
        { "name": "client_features", "type": "u32" }
      ]
    },
    "E2EE_Resp": {
      "fields": [
        { "name": "handshake_id", "type": "string" },
        { "name": "server_eph_pub_b64u", "type": "string" },
        { "name": "nonce_s_b64u", "type": "string" },
        { "name": "server_features", "type": "u32" }
      ]
    },
    "E2EE_Ack": {
      "fields": [
        { "name": "handshake_id", "type": "string" },
        { "name": "timestamp_unix_s", "type": "u64" },
        { "name": "auth_tag_b64u", "type": "string" }
      ]
    }
  }
}
