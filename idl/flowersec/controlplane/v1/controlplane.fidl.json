{
  "namespace": "flowersec.controlplane.v1",
  "enums": {
    "Role": {
      "type": "u8",
      "values": { "client": 1, "server": 2 }
    },
    "Suite": {
      "type": "u16",
      "values": {
        "X25519_HKDF_SHA256_AES_256_GCM": 1,
        "P256_HKDF_SHA256_AES_256_GCM": 2
      }
    }
  },
  "messages": {
    "ChannelInitGrant": {
      "fields": [
        { "name": "tunnel_url", "type": "string" },
        { "name": "channel_id", "type": "string" },
        { "name": "channel_init_expire_at_unix_s", "type": "i64" },
        { "name": "idle_timeout_seconds", "type": "i32" },
        { "name": "role", "type": "Role" },
        { "name": "token", "type": "string" },
        { "name": "e2ee_psk_b64u", "type": "string" },
        { "name": "allowed_suites", "type": "[]Suite" },
        { "name": "default_suite", "type": "Suite" }
      ]
    }
  }
}
