<svg xmlns="http://www.w3.org/2000/svg" width="900" height="320" viewBox="0 0 900 320" role="img" aria-label="Tunnel path (controlplane + tunnel) diagram">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto" markerUnits="strokeWidth">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4b5563" />
    </marker>
  </defs>
  <style>
    .box { fill: #f8fafc; stroke: #0f172a; stroke-width: 1.5; }
    .line { stroke: #4b5563; stroke-width: 1.6; fill: none; }
    .line-dashed { stroke-dasharray: 5 4; }
    .title { font: 13px Arial, Helvetica, sans-serif; fill: #111827; font-weight: 600; }
    .subtitle { font: 12px Arial, Helvetica, sans-serif; fill: #111827; }
    .label { font: 12px Arial, Helvetica, sans-serif; fill: #374151; }
  </style>

  <rect class="box" x="330" y="20" width="240" height="70" rx="8" />
  <text class="title" x="450" y="48" text-anchor="middle">Controlplane demo</text>
  <text class="subtitle" x="450" y="66" text-anchor="middle">mints ChannelInitGrant pair</text>

  <rect class="box" x="40" y="200" width="220" height="70" rx="8" />
  <text class="title" x="150" y="228" text-anchor="middle">Client endpoint</text>
  <text class="subtitle" x="150" y="246" text-anchor="middle">role=client</text>

  <rect class="box" x="340" y="200" width="220" height="70" rx="8" />
  <text class="title" x="450" y="228" text-anchor="middle">Tunnel server</text>
  <text class="subtitle" x="450" y="246" text-anchor="middle">blind forwarder</text>

  <rect class="box" x="640" y="200" width="220" height="70" rx="8" />
  <text class="title" x="750" y="228" text-anchor="middle">Server endpoint</text>
  <text class="subtitle" x="750" y="246" text-anchor="middle">role=server</text>

  <path class="line" d="M 390 90 L 150 200" marker-end="url(#arrow)" />
  <text class="label" x="240" y="145" text-anchor="middle">grant_client</text>

  <path class="line" d="M 510 90 L 750 200" marker-end="url(#arrow)" />
  <text class="label" x="660" y="145" text-anchor="middle">grant_server</text>

  <path class="line line-dashed" d="M 260 215 L 340 215" marker-end="url(#arrow)" />
  <text class="label" x="300" y="190" text-anchor="middle">Attach token + channel_id</text>

  <path class="line line-dashed" d="M 640 215 L 560 215" marker-end="url(#arrow)" />
  <text class="label" x="600" y="190" text-anchor="middle">Attach token + channel_id</text>

  <path class="line" d="M 260 255 L 340 255" marker-end="url(#arrow)" />
  <text class="label" x="300" y="278" text-anchor="middle">
    <tspan x="300" dy="0">E2EE FSEH-FSEC, Yamux</tspan>
    <tspan x="300" dy="14">RPC, echo</tspan>
  </text>

  <path class="line" d="M 560 255 L 640 255" marker-end="url(#arrow)" />
  <text class="label" x="600" y="286" text-anchor="middle">encrypted bytes only</text>
</svg>
